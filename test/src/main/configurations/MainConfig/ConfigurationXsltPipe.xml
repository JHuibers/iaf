<ibis>
	<adapter name="XsltPipe" description="Test the XsltPipe">
		<receiver className="nl.nn.adapterframework.receivers.GenericReceiver"
			name="GenericFunctions">
			<listener className="nl.nn.adapterframework.receivers.JavaListener"
				serviceName="ibis4test-XsltPipe" />
		</receiver>
		<pipeline firstPipe="StylesheetLocationSessionKey">
			<exits>
				<exit path="EXIT" state="success" />
			</exits>
				
			<pipe name="StylesheetLocationSessionKey" className="nl.nn.adapterframework.pipes.PutInSession"
				sessionKey="stylesheetLocation" value="XsltPipe/namespaceAware.xsl">
				<forward name="failure" path="SwitchAction" />
				<forward name="success" path="SwitchAction" />
			</pipe>
			
			<pipe name="SwitchAction" className="nl.nn.adapterframework.pipes.XmlSwitch"
				xpathExpression="request/@action" notFoundForwardName="copy" />

			<pipe name="SetSessionKeyName" className="nl.nn.adapterframework.pipes.XsltPipe"
				styleSheetLocationSessionKey="stylesheetLocation" namespaceAware="true"
				styleSheetName="XsltPipe/TransformXSLT1.xsl">
				<forward name="success" path="StylesheetLocationSessionKey2" />
			</pipe>
				
			<pipe name="StylesheetLocationSessionKey2" className="nl.nn.adapterframework.pipes.PutInSession"
				sessionKey="stylesheetLocation" value="XsltPipe/TransformXSLT1.xsl">
				<forward name="failure" path="SetSessionKeyName2" />
				<forward name="success" path="SetSessionKeyName2" />
			</pipe>

			<pipe name="SetSessionKeyName2" className="nl.nn.adapterframework.pipes.XsltPipe"
				styleSheetLocationSessionKey="stylesheetLocation"
				styleSheetName="XsltPipe/namespaceAware.xsl">
				<forward name="success" path="EXIT" />
			</pipe>
			
			<pipe name="genericFunctions" className="nl.nn.adapterframework.pipes.XsltPipe"
				styleSheetName="XsltPipe/TransformGenericFunctions.xsl">
				<forward name="success" path="EXIT" />
			</pipe>

			<pipe name="Xalan" className="nl.nn.adapterframework.pipes.XsltPipe"
				styleSheetName="XsltPipe/TransformXSLT1.xsl">
				<forward name="success" path="EXIT" />
			</pipe>

			<pipe name="Saxon_XSLT1" className="nl.nn.adapterframework.pipes.XsltPipe"
				styleSheetName="XsltPipe/TransformXSLT1.xsl" xslt2="true">
				<forward name="success" path="EXIT" />
			</pipe>

			<pipe name="Saxon_XSLT2" className="nl.nn.adapterframework.pipes.XsltPipe"
				styleSheetName="XsltPipe/TransformXSLT2.xsl" xslt2="true">
				<forward name="success" path="EXIT" />
			</pipe>

			<pipe name="copyNamespace" className="nl.nn.adapterframework.pipes.XsltPipe"
				styleSheetName="XsltPipe/copyNamespace.xsl">
				<forward name="success" path="EXIT" />
			</pipe>

			<pipe name="multipleSelects" className="nl.nn.adapterframework.pipes.XsltPipe"
				styleSheetName="XsltPipe/multipleSelects.xsl">
				<forward name="success" path="EXIT" />
			</pipe>

			<pipe name="namespaceAware" className="nl.nn.adapterframework.pipes.XsltPipe"
				styleSheetName="XsltPipe/namespaceAware.xsl" namespaceAware="true">
				<forward name="success" path="EXIT" />
			</pipe>

			<pipe name="copy" className="nl.nn.adapterframework.pipes.XsltPipe"
				styleSheetName="XsltPipe/copy.xsl">
				<forward name="success" path="EXIT" />
			</pipe>
		</pipeline>
	</adapter>
</ibis>